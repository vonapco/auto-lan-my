### **Документация: Разработка и Траблшутинг мода "AutoLan"**

Этот документ содержит набор правил и рекомендаций для разработчиков и пользователей мода `AutoLan`, основанный на анализе логов ошибок. Цель - предотвратить распространенные проблемы и обеспечить стабильную работу мода.

#### **Часть 1: Руководство для Разработчиков Мода**

Эти правила помогут улучшить качество и надежность мода `AutoLan`.

##### **Правило 1: Управление Зависимостями**

**Проблема:**
Мод жестко привязан к конкретной версии Minecraft. Запуск с неподдерживаемой версией приводит к падению игры при загрузке.

**Рекомендации:**
1.  **Четкая документация:** Всегда четко указывайте совместимую версию Minecraft для каждого релиза мода на страницах скачивания (CurseForge, Modrinth и т.д.).
2.  **Гибкие версии в `fabric.mod.json`:** По возможности используйте диапазоны версий, если мод совместим с несколькими патч-версиями игры. Например, вместо `"minecraft": "1.21.5"` можно использовать `"minecraft": ">=1.21 <1.22"`, если мод поддерживает все версии `1.21.x`. Это уменьшит количество проблем совместимости для пользователей.
3.  **Улучшение обратной связи:** Хотя Fabric Loader предоставляет информацию об ошибке, можно добавить собственную, более дружелюбную проверку версии при инициализации мода и выводить в лог понятное сообщение для пользователя.

##### **Правило 2: Обработка Конфигурационных Файлов**

**Проблема:**
Мод падает с ошибкой `java.io.FileNotFoundException: ... (Отказано в доступе)`, если у него нет прав на запись конфигурационного файла `autolan.toml`. Это делает мод неработоспособным до тех пор, пока пользователь вручную не исправит права доступа.

**Рекомендации:**
1.  **Отказоустойчивая загрузка конфигурации:** Реализуйте более надежную систему обработки ошибок при сохранении/загрузке конфигурации.

    *   **Пример реализации:**
        ```java
        // В классе, отвечающем за конфигурацию
        
        public static void saveConfig(AutoLanConfig config) {
            try {
                // Попытка сохранить конфигурацию
                // ... ваш код сохранения ...
            } catch (IOException e) {
                // Если возникла ошибка, особенно связанная с доступом
                LOGGER.error("Не удалось сохранить конфигурационный файл 'autolan.toml'.");
                LOGGER.error("Убедитесь, что у игры есть права на запись в папку 'config'.");
                LOGGER.error("Мод будет использовать конфигурацию по умолчанию. Изменения не будут сохранены.", e);
                // Не прерывайте выполнение, просто используйте значения по умолчанию.
            }
        }
        ```

2.  **Загрузка с использованием значений по умолчанию:** Если файл конфигурации не может быть создан или прочитан, мод должен продолжать работать, используя встроенные значения по умолчанию. Это обеспечит частичную функциональность и не приведет к полному отказу.

3.  **Информативные сообщения об ошибках:** Вместо простого стектрейса, выводите в лог четкое сообщение, объясняющее проблему (нет прав на запись), путь к проблемному файлу и возможные шаги для решения (запуск от имени администратора, проверка прав на папку).

---

#### **Часть 2: Руководство для Пользователей Мода (Трабблшутинг)**

Если вы столкнулись с проблемами при использовании `AutoLan`, следуйте этим шагам.

##### **Проблема 1: Игра не запускается, ошибка "Incompatible mods"**

**Причина:** Версия мода `AutoLan` несовместима с вашей версией Minecraft.

**Решение:**
1.  **Проверьте версии:** Внимательно посмотрите на страницу, где вы скачивали мод. Убедитесь, что версия мода предназначена для той версии Minecraft, которую вы используете.
2.  **Скачайте правильную версию:** Удалите текущий файл мода и скачайте версию, совместимую с вашим клиентом игры.

##### **Проблема 2: Ошибка "Failed to save config" или "Отказано в доступе" в логах**

**Причина:** У игры нет необходимых прав для создания или изменения файла конфигурации мода (`.minecraft/config/autolan.toml`).

**Решение:**
1.  **Проверьте антивирус:** Убедитесь, что ваш антивирус или защитник Windows не блокирует Java-процесс (javaw.exe) или доступ к папке AppData. Иногда "Защита от программ-шантажистов" может вызывать такие проблемы.
2.  **Запуск от имени администратора:** Попробуйте запустить ваш лаунчер Minecraft от имени администратора. Для этого кликните правой кнопкой мыши по ярлыку лаунчера и выберите "Запуск от имени администратора". *Примечание: это хороший диагностический шаг, но не рекомендуется для постоянного использования из соображений безопасности.*
3.  **Проверьте права на папку:**
    *   Перейдите в папку `.minecraft/config`.
    *   Нажмите правой кнопкой мыши на папку `config`, выберите "Свойства" -> вкладка "Безопасность".
    *   Выберите своего пользователя в списке и убедитесь, что у него есть права на "Запись" (Write). Если нет, нажмите "Изменить" и установите их.
4.  **Проверьте атрибуты файла:** Если файл `autolan.toml` уже существует, нажмите на него правой кнопкой мыши, выберите "Свойства" и убедитесь, что не установлен флажок "Только для чтения". 